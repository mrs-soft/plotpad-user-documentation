Формирование документов
=======================

В программе доступны три вида документов:

#.  Сводный отчет
#.  Предписание
#.  Акт

Сводный отчет
-------------

Генерация документов доступна в разделе «Замечания».
Отчет можно составить по всему списку отфильтрованных замечаний.

Чтобы отфильтровать список замечаний для отчета:

#.  В строке поиска пропишите ключевые слова для фильтрации.
#.  Воспользуйтесь фильтром по статусу замечания (открытые, выполненные, проверенные).
#.  Установите специальные фильтры, нажав на кнопку "Фильтрации".

Далее нажимаем на кнопку «Сформировать документ» (Рис. 1).

..  only:: html

    ..  thumbnail:: images/document-creation/document-creation-1-document-creating.gif
        :alt: Формирование документа
        :align: center
        :class: framed
        :title: Рис. 1. Формирование документа
        :show_caption: True

..  only:: latex

    ..  figure:: images/document-creation/document-creation-1-document-creating.png
        :alt: Формирование документа
        :align: center

        Рис. 1. Формирование документа

В открывшемся окне выбираем тип документа **Отчет** (Рис. 2).

..  thumbnail:: images/document-creation/document-creation-2-doc-types.png
    :alt: Формирование документа
    :width: 60%
    :class: framed
    :title: Рис. 2. Типы документов
    :show_caption: True

Далее выбираем необходимую вам форму отчёта. На Рис. 3 представлена только одна форма, так как это демонстрационный проект.

..  thumbnail:: images/document-creation/document-creation-3-report.png
    :alt: Формирование документа
    :width: 60%
    :class: framed
    :title: Рис. 3. Формирование отчёта
    :show_caption: True

В Excel файле все замечания представлены в следующем разрезе:

*   номер замечания;
*   название и описание;
*   дата выдачи;
*   ответственная организация;
*   представитель ответственной организации;
*   требуемый срок устранения;
*   отметка об устранении;
*   фактическая дата устранения;
*   представитель организации, выдавшей предписание;
*   представитель организации, снявшей предписание;
*   уровень структуры.

Предписание
-----------

Предписание можно создавать как по каждому замечанию, так и по списку замечаний.

Для того, чтобы создать предписание по конкретному замечанию, перейдите в карточку замечания.
Нажмите на кнопку «Сформировать документ», после выберите в типе документа **предписание**.
Потом определитесь с формой предписания из предложенных в списке.
Также вы можете задать в ручную номер документа и дату формирования документа (Рис. 4).

По готовности предписание будет добавлено в приложения к замечанию.

..  only:: html

    ..  thumbnail:: images/document-creation/document-creation-4-single-order.gif
        :alt: Формирование единичного предписания
        :align: center
        :class: framed
        :title: Рис. 4. Создание предписание по одному замечанию
        :show_caption: True

..  only:: latex

    ..  figure:: images/document-creation/document-creation-4-single-order.png
        :alt: Формирование единичного предписания
        :align: center

        Рис. 4. Создание предписание по одному замечанию

Для создания предписания по списку замечаний сначала отфильтруйте их так, как вам необходимо.

..  note:: В предписание попадают все замечания из реестра после фильтрации.

Нажмите на кнопку «Сформировать документ», после выберите в типе документа **предписание**
и в типе предписания выберите **массовое предписание** (Рис. 5).

..  only:: html
    
    ..  thumbnail:: images/document-creation/document-creation-5-mass-order.gif
        :alt: Формирование предписаний по нескольким замечаниям
        :align: center
        :class: framed
        :title: Рис. 5. Формирование предписаний по нескольким замечаниям
        :show_caption: True

..  only:: latex

    ..  figure:: images/document-creation/document-creation-5-mass-order.png
        :alt: Формирование предписаний по нескольким замечаниям
        :align: center

        Рис. 5. Формирование предписаний по нескольким замечаниям

Процесс генерации может занять несколько минут, затем сформированный документ будет отправлен на электронную почту,
которую вы используете для входа в программу.

..  attention:: Сформированный документ также будет доступен для скачивания в разделе основного меню «Документооборот».

В предписание подставляются данные об организациях и объекте, которые берутся из настроек проекта, а именно:

*   название объекта;
*   полный адрес объекта;
*   город;
*   номер замечания;
*   название организации, выдающей предписание;
*   ФИО и должность человека, выдающего предписание;
*   название организации, получающей предписание;
*   ФИО и должность человека, получающего предписание.

Разработчик создаст ту форму предписания, которую предоставит заказчик.
Сформированное предписание отгружается в текстовом формате с возможностью редактирования его в текстовом редакторе, например, Microsoft Word.

Акт об устранении выявленных нарушений
--------------------------------------

При переводе замечания в статус выполнен или проверен в замечании появляется возможность создать акт об устранении выявленных нарушений. 

Для того, чтобы создать акт по конкретному замечанию, перейдите в карточку замечания.
Измените статус замечания на выполнен или проверен, нажмите на кнопку «Сформировать документ», после выберите тип документа,
в данном случае это Акт, и выберите необходимую вам форму документа (Рис. 6). По готовности акт будет добавлен во вложения к замечанию.

..  only:: html
    
    ..  thumbnail:: images/document-creation/document-creation-6-completion-certificate.gif
        :alt: Формирование акта
        :align: center
        :class: framed
        :title: Рис. 6. Создание акта по замечанию
        :show_caption: True

..  only:: latex

    ..  figure:: images/document-creation/document-creation-6-completion-certificate.png
        :alt: Формирование акта
        :align: center

        Рис. 6. Создание акта по замечанию